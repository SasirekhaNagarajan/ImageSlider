Lyte.Component.register("lyte-tooltip",{_template:'<template tag-name="lyte-tooltip">\n   \n</template>',_dynamicNodes:[],_observedAttributes:["ltPropId","ltPropClass","ltPropKeepAlive","eventListeners"],init:function(){this._dir=_lyteUiUtils.getRTL(),this.getMethods("beforeRender")&&this.executeMethod("beforeRender",this.$node)},rtlfunc:function(t,e,o){if(this._dir&&"top"!=t&&"clientY"!=t){if(e)return"right"==t?o-e.left:"clientX"==t?o-e.clientX:o-e.right;if("left"==t)return"right";if("right"==t)return"left"}return e?e[t]:t},data:function(){return{ltPropId:Lyte.attr("string",{default:""}),ltPropClass:Lyte.attr("string",{default:""}),ltPropKeepAlive:Lyte.attr("boolean",{default:!1}),eventListeners:Lyte.attr("object",{default:{}})}},didConnect:function(){var t=document.body.querySelectorAll("lyte-tooltip");if(this._clickHide=this.clickHide,t.length>1)for(var e=0;e<t.length;e++)t[e].getAttribute("lt-prop-class")||t[e].getAttribute("lt-prop-id")||t[e]==this.$node||t[e].parentElement.removeChild(t[e]);var o=this.mousemove.bind(this);this.setData("eventListeners.mousemove",o),document.addEventListener("mousemove",o,!0),window.addEventListener("scroll",this.tooltipScroll,!0),this._mousedown=this.mousedown.bind(this),this._mouseup=this.mouseup.bind(this),this._keydown=this.keydown.bind(this),document.addEventListener("keydown",this._keydown,!0),document.addEventListener("mousedown",this._mousedown,!0),this.getMethods("afterRender")&&this.executeMethod("afterRender",this.$node),$L.fastdom.measure(function(){var t="rtl"==window.getComputedStyle(this.$node).getPropertyValue("direction");$L.fastdom.mutate(function(){t&&(this.direction=!0)}.bind(this))}.bind(this))},tooltipScroll:function(t){for(var e=document.querySelectorAll("body span.lyteTooltip:not(.lyteTooltipHidden)"),o=0;o<e.length;o++)e[o].classList.add("lyteTooltipHidden")},mousedown:function(t){this._mousedownFlag=!0,(t.target.correspondingElement||t.target).classList.contains("lyteSliderHandler")&&(delete this.prevTooltipNode,this._slider=!0),this.closeAllTooltip(),document.addEventListener("mouseup",this._mouseup,!0)},mouseup:function(t){if(delete this._mousedownFlag,document.removeEventListener("mouseup",this._mouseup,!0),this._slider){delete this._slider;var e=t.target.correspondingElement||t.target;e.classList.contains("lyteSliderHandler")&&this.mousemove({target:e})}},keydown:function(t){delete this.prevTooltipNode,this.closeAllTooltip()},tooltipOpenCallback:function(t,e){t.onTooltipShow&&t.onTooltipShow.apply(this,arguments),this.getMethods("onTooltipShow")&&this.executeMethod("onTooltipShow",t,e,t.tooltip)},tooltipCloseCallback:function(t){t.onTooltipHide&&t.onTooltipHide.apply(this,arguments),this.getMethods("onTooltipHide")&&this.executeMethod("onTooltipHide",t)},didDestroy:function(){window.removeEventListener("scroll",this.tooltipScroll,!0),document.removeEventListener("mousemove",this.getData("eventListeners").mousemove,!0),document.removeEventListener("mousedown",this._mousedown,!0),document.removeEventListener("keydown",this._keydown,!0);for(var t=document.body.querySelectorAll("span.lyteTooltip"),e=0;e<t.length;e++)delete t[e].nodeName1.tooltipSpan,delete t[e].nodeName1.tooltip,document.body.removeChild(t[e])},propertySetting:function(t){if(e=t.getAttribute("lt-prop-tooltip-config")){var e=JSON.parse(e);for(var o in e)t.tooltip.config[o]=e[o]}},createTooltip:function(t,e,o){o?this.followcursor.call(this,t,e):this.nonFollowcursor.call(this,t,e),this.getData("ltPropKeepAlive")||1!=e.nodeName1.tooltip.config.keeptooltip&&"true"!=e.nodeName1.tooltip.config.keeptooltip&&(e.nodeName1.tooltip.maxdisp=setTimeout(function(){if(document.body.contains(e)){this.prevTooltipNode==e.nodeName1&&delete this.prevTooltipNode;var t=e.nodeName1;delete e.nodeName1.tooltipSpan,delete e.nodeName1.tooltip,document.body.removeChild(e),this.tooltipCloseCallback(t)}}.bind(this),e.nodeName1.tooltip.config.maxdisplaytime))},followcursor:function(t,e){if(document.body.contains(e)){e._callbackHandled||(this.tooltipOpenCallback(e.nodeName1,e),e._callbackHandled=!0);var o=(window.pageXOffset||document.documentElement.scrollLeft)*(this._dir?-1:1),i=window.pageYOffset||document.documentElement.scrollTop;e.style[this.rtlfunc.call(this,"left")]=this.rtlfunc.call(this,"clientX",t,window.innerWidth)+o+"px",e.style.top=t.clientY+i+5+Math.min(parseInt(e.nodeName1.tooltip.config.margin),20)+"px",e.classList.remove("lyteTooltipHidden")}},createsupp:function(t){var e=document.createElement("span");return e.classList.add("lyteTooltipInnerSpan"),t.classList.add("lyteInnerToolAdded"),t.appendChild(e)},rightalign:function(t,e,o,i,l,s,n,r,a,d,p,c,h){if(t+e<o+i.width)return l.classList.remove(a),s||this.nonFollowcursor(n,l,d,!0),!0;if(o<e){if(h)this.createsupp(l).style[r]=.75*c-p+"px";l.style[r]=0}else l.style[r]=o+"px"},nonFollowcursor:function(t,e,o,i){var l,s="callout"==e.nodeName1.tooltip.config.appearance;e.classList.remove("lyteTooltipHidden"),l=(o=o||e.nodeName1.tooltip.config.position)||"bottom",s&&e.classList.add("lyte"+l[0].toUpperCase()+l.slice(1)),e._callbackHandled||(this.tooltipOpenCallback(e.nodeName1,e),e._callbackHandled=!0),$L.fastdom.measure(function(){if(e.nodeName1.tooltip){var l,n=(window.pageXOffset||document.documentElement.scrollLeft)*(this._dir?-1:1),r=window.pageYOffset||document.documentElement.scrollTop,a=window.innerWidth,d=window.innerHeight,p=e.getBoundingClientRect(),c=e.nodeName1.getBoundingClientRect(),h=this.rtlfunc.call(this,"left",c,a)+n,m=c.top+r,u=Math.min(parseInt(e.nodeName1.tooltip.config.margin),20),f=e.offsetWidth,y=c.width,g=c.height,b=this.rtlfunc.call(this,"left");switch(s?(l=parseFloat(window.getComputedStyle(e,":before").getPropertyValue("width"))/2*1.414,!isNaN(l)&&l||(l=parseFloat(window.getComputedStyle(e,"left"==o?":before":":after").getPropertyValue("border-left-width")))):l=0,o.toLowerCase()){case"right":var v=(h+=l)+y+u+"px";e.style.top=m+g/2-e.offsetHeight/2+"px",a+n<parseInt(v)+p.width?(e.classList.remove("lyteRight"),i||this.nonFollowcursor.call(this,t,e,"left",!0)):e.style[b]=v;break;case"left":v=(h-=l)-u-f+"px";e.style.top=m+g/2-e.offsetHeight/2+"px",parseInt(v)<n?(e.classList.remove("lyteLeft"),i||this.nonFollowcursor.call(this,t,e,"right",!0)):e.style[b]=v;break;case"bottom":v=h+y/2-f/2;if(r+d<(w=(m+=l)+g+u)+p.height&&(e.classList.remove("lyteBottom"),!i)){this.nonFollowcursor.call(this,t,e,"top",!0);break}v=this.horicheck(v,n,a,p,e,c,b,l,s),e.style[b]=v+"px",e.style.top=w+"px";break;case"top":v=h+y/2-f/2;if((w=(m-=l)-u-e.clientHeight)<r&&(e.classList.remove("lyteTop"),!i)){this.nonFollowcursor.call(this,t,e,"bottom",!0);break}v=this.horicheck(v,n,a,p,e,c,b,l,s),e.style[b]=v+"px",e.style.top=w+"px";break;case"bottomright":v=h+.75*y-.2*f;var w=(m+=l)+g+u;if(this.rightalign(a,n,v,p,e,i,t,b,"lyteBottomright","bottomleft",l,y,s))break;if(d+r<w+p.height){e.classList.remove("lyteBottomright"),i||this.nonFollowcursor.call(this,t,e,"topright",!0);break}e.style.top=w+"px";break;case"topright":v=h+.75*y-.2*f,w=(m-=l)-e.clientHeight-u;if(this.rightalign(a,n,v,p,e,i,t,b,"lyteTopright","topleft",l,y,s))break;if(w<r){e.classList.remove("lyteTopright"),i||this.nonFollowcursor.call(this,t,e,"bottomright",!0);break}e.style.top=w+"px";break;case"bottomleft":v=h-.8*f+.25*y+"px",w=(m+=l)+g+u+"px";if(parseInt(v)<n){e.classList.remove("lyteBottomleft"),i||this.nonFollowcursor.call(this,t,e,"bottomright",!0);break}if(e.style[b]=v,d+r<parseInt(w)+p.height){e.classList.remove("lyteBottomleft"),i||this.nonFollowcursor.call(this,t,e,"topleft",!0);break}e.style.top=w;break;case"topleft":v=h-.8*f+.25*y+"px",w=(m-=l)-parseInt(e.clientHeight)-u+"px";if(parseInt(v)<n){e.classList.remove("lyteTopleft"),i||this.nonFollowcursor.call(this,t,e,"topright",!0);break}if(e.style[b]=v,parseInt(w)<r){e.classList.remove("lyteTopleft"),i||this.nonFollowcursor.call(this,t,e,"bottomleft",!0);break}e.style.top=w;break;default:var T=l;v=this.rtlfunc.call(this,"clientX",t,a)-f/2;if(d+r<(w=m+T+g+u)+p.height&&(e.classList.remove("lyteBottom"),!i)){this.nonFollowcursor.call(this,t,e,"top",!0);break}v=this.horicheck(v,n,a,p,e,c,b,l,s),e.style[b]=v+"px",e.style.top=w+"px"}e.style[this.rtlfunc("right")]="auto"}}.bind(this))},horicheck:function(t,e,o,i,l,s,n,r,a){var d,p;if(t<e?(t=e,d=!0):o+e<t+i.width&&(t=o-i.width+e,p=!0),(d||p)&&a){var c=this.createsupp(l),h=this.rtlfunc("left",s,o);c.style[n]=(d?Math.max((h+s.width)/2,h+s.width/2):i.width-Math.max((o-h)/2,o-h-s.width/2))+"px"}return t},closeAllTooltip:function(t){for(var e=document.body.querySelectorAll("span.lyteTooltip"),o=0;o<e.length;o++)e[o].nodeName1!=t&&document.body.contains(e[o])&&(e[o].nodeName1.tooltip.bodyTimeout=setTimeout(this.removeTooltip.bind(this),e[o].nodeName1.tooltip.config.hidedelay,e[o],event))},removeTooltip:function(t,e){if(document.body.contains(t)){clearTimeout(t.nodeName1.tooltip.disptime),clearTimeout(t.nodeName1.tooltip.maxdisp),clearTimeout(t.nodeName1.tooltip.settime),this.prevTooltipNode==t.nodeName1&&delete this.prevTooltipNode;var o=t.nodeName1;delete t.nodeName1.tooltipSpan,delete t.nodeName1.tooltip,document.body.removeChild(t),this.tooltipCloseCallback(o)}},mousemove:function(t){if(!this._mousedownFlag){for(var e=t.target.correspondingElement||t.target;e&&"BODY"!=e.tagName&&e!=document&&"HTML"!=e.tagName;){if(e.getAttribute&&e.getAttribute("lt-prop-title")){if(e.getAttribute("title")&&e.removeAttribute("title"),e.hasOwnProperty("tooltip")||(e.tooltip={}),e.tooltip.config={position:"",appearance:"callout",margin:0,showdelay:0,hidedelay:0,maxdisplaytime:5e3,keeptooltip:!1},e.tooltip.title=e.getAttribute("lt-prop-title"),this.propertySetting.call(this,e),this.prevTooltipNode==e||e.tooltip.tooltipSpan)if("followcursor"==e.tooltip.config.position&&this.prevTooltipNode==e&&e.tooltip.tooltipSpan){o=e.tooltip.tooltipSpan;clearTimeout(o.nodeName1.tooltip.maxdisp),clearTimeout(o.nodeName1.tooltip.settime),o._callbackHandled?this.followcursor.call(this,t,o):o.nodeName1.tooltip.settime=setTimeout(this.createTooltip.bind(this),o.nodeName1.tooltip.config.showdelay,t,o,!0)}else e.tooltip.tooltipSpan&&"none"==e.tooltip.tooltipSpan.style.display?(e.tooltip.tooltipSpan.style.display="",clearTimeout(e.tooltip.maxdisp),clearTimeout(e.tooltip.settime),clearTimeout(e.tooltip.bodyTimeout),e.tooltip.settime=setTimeout(this.createTooltip.bind(this),e.tooltip.config.showdelay,t,e.tooltip.tooltipSpan,"followcursor"==e.tooltip.config.position)):this.prevTooltipNode=e;else{this.prevTooltipNode=e;var o=document.createElement("span"),i=e.getAttribute("lt-prop-tooltip-class"),l=this.getData("ltPropId"),s=this.getData("ltPropClass");if(l&&o.setAttribute("id",l),s&&o.classList.add(s),o.classList.add("lyteTooltip"),this.direction&&o.classList.add("lyteRTL"),o.classList.add("lyteTooltipHidden"),e.getAttribute("lt-prop-tooltip-style")&&(o.setAttribute("style",e.getAttribute("lt-prop-tooltip-style")),o.style.borderColor||(o.style.borderColor=o.style.backgroundColor)),"callout"==e.tooltip.config.appearance&&o.classList.add("lyteTooltipCallout"),e.tooltip.tooltipSpan=o,o.nodeName1=e,i)for(var n=i.split(" "),r=0;r<n.length;r++)o.classList.add(n[r]);e.tooltip.settime=setTimeout(this.createTooltip.bind(this),o.nodeName1.tooltip.config.showdelay,t,o,"followcursor"==o.nodeName1.tooltip.config.position),o.textContent=o.nodeName1.tooltip.title,document.body.appendChild(o)}this.closeAllTooltip.call(this,e);break}e=e.parentNode}e&&-1!=["BODY","HTML"].indexOf(e.tagName)&&this.prevTooltipNode!=e&&(delete this.prevTooltipNode,this.closeAllTooltip.call(this))}}}),"complete"==document.readyState||"interactive"==document.readyState?document.body.querySelectorAll("lyte-tooltip").length||document.body.appendChild(document.createElement("lyte-tooltip")):document.addEventListener("DOMContentLoaded",function(t){document.body.querySelectorAll("lyte-tooltip").length||document.body.appendChild(document.createElement("lyte-tooltip"))});