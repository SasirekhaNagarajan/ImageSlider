Lyte.Component.register("lyte-nav",{_template:'<template tag-name="lyte-nav">\n\t<template is="if" value="{{expHandlers(ltPropAlignment,\'!==\',\'vertical\')}}"><template case="true">\n\t\t<template is="if" value="{{ltPropNavYield}}"><template case="true">\n\t\t\t<lyte-yield yield-name="nav" items="{{auxArray}}"></lyte-yield>\n\t\t</template><template case="false">\n\t\t\t<template is="for" items="{{auxArray}}" item="item" index="index">\n\t\t\t\t<lyte-nav-item data-value="{{item[ltPropSystemValue]}}">{{item[ltPropUserValue]}}</lyte-nav-item>\n\t\t\t</template>\n\t\t</template></template>\n\t\t\n\t\t<template is="if" value="{{expHandlers(ltPropType,\'===\',\'collapse\')}}"><template case="true">\n\t\t\t<template is="if" value="{{expHandlers(expHandlers(menuContent.length,\'>\',0),\'||\',showMenu)}}"><template case="true">\n\t\t\t\t<span class="{{ltPropContainerClass}}">\n\t\t\t\t\t<span class="{{ltPropMenuIcon}}"></span>\n\t\t\t\t</span>\n\t\t\t</template></template>\n\t\t\t<lyte-menu lt-prop="{{stringify(ltPropMenu)}}" on-menu-click="{{method(\'itemSelected\')}}" on-before-open="{{method(\'beforeOpen\')}}" on-open="{{method(\'open\')}}" on-before-close="{{method(\'beforeClose\')}}" on-close="{{method(\'close\')}}" before-render="{{method(\'befRender\')}}" after-render="{{method(\'aftRender\')}}">\n\n\t\t\t\t<template is="registerYield" yield-name="yield">\n\t\t\t\t\t<template is="if" value="{{ltPropMenuYield}}"><template case="true">\n\t\t\t\t\t\t<lyte-yield yield-name="menu" items="{{menuContent}}"></lyte-yield>\n\t\t\t\t\t</template><template case="false">\n\t\t\t\t\t\t<lyte-menu-body class="{{ltPropNavMenuClass}}">\n\t\t\t\t\t\t\t<template is="for" items="{{menuContent}}" item="item" index="index">\n\t\t\t\t\t\t\t\t<lyte-menu-item data-value="{{item[ltPropSystemValue]}}">\n\t\t\t\t\t\t\t\t\t<lyte-menu-label>\n\t\t\t\t\t\t\t\t\t\t{{item[ltPropUserValue]}}\n\t\t\t\t\t\t\t\t\t</lyte-menu-label>\n\t\t\t\t\t\t\t\t</lyte-menu-item>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</lyte-menu-body>\n\t\t\t\t\t</template></template>\n\t\t\t\t</template>\n\n\t\t\t</lyte-menu>\n\t\t</template></template>\n\t\t\n\t</template></template>\n</template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}}],_observedAttributes:["ltPropMenu","ltPropNavYield","ltPropMenuYield","ltPropItems","ltPropUserValue","ltPropSystemValue","ltPropMaxWidth","ltPropType","ltPropNavMenuClass","ltPropMenuIcon","ltPropContainerClass","ltPropClick","ltPropAlignment","menuContent","auxArray","arrowTop","arrowBot","showMenu"],init:function(){var t=this.getData("ltPropMenu"),e=this.getData("ltPropContainerClass");$L.fastdom.measure(function(){_lyteUiUtils.nav_innerWidth||(_lyteUiUtils.nav_innerWidth=document.documentElement.clientWidth)}),Lyte.objectUtils(t,"add","yield",!0),Lyte.objectUtils(t,"add","query","."+e)},didDestroy:function(){for(var t=this.$node.querySelectorAll("lyte-nav-item"),e=0;e<t.length;e++)t[e].getAttribute("lyte-shortcut")&&t[e].setAttribute("lyte-shortcut",JSON.stringify({}))},createOuterDiv:function(){var t=document.createElement("div");return t.setAttribute("class","lyteNavDiv"),t.style.overflow="hidden",t},show:function(t,e){this.setData("topH",t[0].getBoundingClientRect().height),this.setData("botH",t[1].getBoundingClientRect().height),this.dispArrow.call(this,t,e),this.getMethods("afterRender")&&this.executeMethod("afterRender",this)},construct:function(){for(var t,e=this.getData("ltPropItems")||[],a=0,i=this.getData("ltPropUserValue"),n=this.getData("ltPropSystemValue"),o=[];a<e.length;a++)(t={})[i]=e[a][i],t[n]=e[a][n],Lyte.arrayUtils(o,"push",t);this.setData("auxArray",o)},recalculate:function(){var t,e=this.getCurrentSelected(),a=this.getDataValue(e);this.getData("ltPropClick");this.construct(),(t=this.$node.querySelector('lyte-nav-item[data-value="'+window._lyteUiUtils.escape(a)+'"]'))&&t.setAttribute("selected",!0),this.collapse()},itemsOb:function(){this.recalculate()}.observes("ltPropItems"),getCurrentSelected:function(){var t=this.getData("ltPropClick");return this.$node.querySelector("lyte-nav-item."+t)},getDataValue:function(t){return t?t.getAttribute("data-value"):""},getWidth:function(t){return t?t.getBoundingClientRect().width:0},getMenuWidth:function(){var t,e;return this.setData("showMenu",!0),t=this.$node.querySelector("."+this.getData("ltPropContainerClass")),e=this.getWidth(t),this.setData("showMenu",!1),e},collapse:function(){$L.fastdom.measure(function(){var t,e,a=this.getData("auxArray"),i=[],n=[],o=this.$node.getBoundingClientRect(),l=parseFloat(this.getData("ltPropMaxWidth"))/100,s=o.width*l,r=0,p=(a.length,this.getData("ltPropSystemValue")),d=0,c=this.getCurrentSelected(),u=this.getDataValue(c);for(d=d+this.getWidth(c)+this.getMenuWidth();r<a.length;r++)(e=a[r])[p]!==u&&(d+=this.getWidth(this.$node.querySelector('lyte-nav-item[data-value="'+window._lyteUiUtils.escape(e[p])+'"]')))>s&&(Lyte.arrayUtils(i,"push",e),n.push(r));for(this.setData("menuContent",i);!isNaN(t=n.pop());)Lyte.arrayUtils(a,"removeAt",t,1)},this)},didConnect:function(){var t,e,a,i,n,o=this.getData("ltPropAlignment"),l=this.$node,s=l.children,r=s.length;if("horizontal"===o)t=this.getData("ltPropType"),(this.getData("ltPropItems")||[]).length>0&&(this.construct(),"collapse"===t&&this.collapse());else if("vertical"===o){for(e=this.createOuterDiv(),a=l.querySelectorAll("lyte-arrow"),i=0;i<r;i++)LyteComponent.appendChild(e,s[0]);LyteComponent.appendChild(l,e),0==a.length?(this.addArrow("arrow-up"),this.addArrow("arrow-down")):(l.insertBefore(a[0],l.children[0]),l.appendChild(a[1])),a=l.querySelectorAll("lyte-arrow"),$L.fastdom.measure(this.show.bind(this,a,e)),n=l.querySelector(".lyteNavDiv"),a[0].addEventListener("mouseenter",this.moveup.bind(this)),a[1].addEventListener("mouseenter",this.movedown.bind(this));var p=this;n.addEventListener("wheel",function(t){var e,i,o,l=t.deltaY,s=n.scrollHeight,r=n.getBoundingClientRect().height,d=n.scrollTop;t.preventDefault(),Math.floor(s)!=Math.floor(r)&&(e=a[0].getBoundingClientRect().height,i=a[1].getBoundingClientRect().height,l<0&&(d=n.scrollTop=n.scrollTop-6,"none"===a[1].style.display&&(a[1].style.display="inline-block",o=e+(i=p.getData("botH")),n.style.height="calc(100% - "+o+"px)"),d<=0&&(a[0].style.display="none",n.style.height="calc(100% - "+i+"px)")),l>0&&(d=n.scrollTop=n.scrollTop+6,"none"===a[0].style.display&&(a[0].style.display="inline-block",o=(e=p.getData("topH"))+i,n.style.height="calc(100% - "+o+"px)"),Math.floor(r)+Math.floor(d)>=Math.floor(s)&&(a[1].style.display="none",n.style.height="calc(100% - "+e+"px)")))}),a[0].addEventListener("mouseleave",this.removeup.bind(this)),a[1].addEventListener("mouseleave",this.removedown.bind(this))}},removedown:function(){window.cancelAnimationFrame(this.getData("arrowdid"))},removeup:function(){window.cancelAnimationFrame(this.getData("arrowuid"))},down:function(t,e,a){var i,n=t.scrollTop,o=t.scrollHeight,l=t.getBoundingClientRect().height;n+l<o&&(n=t.scrollTop=t.scrollTop+3),Math.floor(l)+Math.floor(n)>=o&&(e[1].style.display="none",t.style.height="calc(100% - "+a+"px)"),i=window.requestAnimationFrame(this.down.bind(this,t,e,a)),this.setData("arrowdid",i)},up:function(t,e,a){var i,n=t.scrollTop;0!==n&&(n=t.scrollTop=t.scrollTop-3),n<=0&&(e[0].style.display="none",t.style.height="calc(100% - "+a+"px)"),i=window.requestAnimationFrame(this.up.bind(this,t,e,a)),this.setData("arrowuid",i)},movedown:function(){var t,e,a=this.$node,i=a.querySelector(".lyteNavDiv"),n=a.querySelectorAll("lyte-arrow");i.getBoundingClientRect().height,i.scrollHeight;n[0].style.display="inline-block",e=this.getData("topH")+(t=this.getData("botH")),i.style.height="calc(100% - "+e+"px)",window.requestAnimationFrame(this.down.bind(this,i,n,t))},moveup:function(){var t,e,a=this.$node,i=a.querySelector(".lyteNavDiv"),n=a.querySelectorAll("lyte-arrow");i.getBoundingClientRect().height,i.scrollHeight;n[1].style.display="inline-block",e=(t=this.getData("topH"))+this.getData("botH"),i.style.height="calc(100% - "+e+"px)",window.requestAnimationFrame(this.up.bind(this,i,n,t))},addArrow:function(t){var e=document.createElement("i"),a=document.createElement("lyte-arrow"),i=this.$node;e.setAttribute("class",t),a.appendChild(e),-1!==t.indexOf("up")?i.insertBefore(a,i.children[0]):i.appendChild(a)},dispArrow:function(t,e){var a=0,i=0,n=0,o=0;switch(this.getData("arrowTop")&&(i=this.getData("topH"),a=1),this.getData("arrowBot")&&(n=this.getData("botH"),a=1==a?3:2),a){case 1:e.style.height="calc(100% - "+i+"px)",t[1].style.display="none";break;case 2:e.style.height="calc(100% - "+n+"px)",t[0].style.display="none";break;case 3:o=i+n,e.style.height="calc(100% - "+o+"px)"}},recreateFromDv:function(t){for(var e=this.getData("ltPropSystemValue"),a=0,i={},n=this.getData("ltPropUserValue"),o=this.getData("ltPropItems")||[];a<o.length;a++)if(o[a][e]===t)return i[n]=o[a][n],i[e]=t,i},findInd:function(t){for(var e=this.getData("menuContent"),a=0,i=(this.getData("ltPropUserValue"),this.getData("ltPropSystemValue"));a<e.length;a++)if(t==e[a][i])return a},setSelected:function(t){var e=this.$node.querySelector('lyte-nav-item[data-value="'+window._lyteUiUtils.escape(t)+'"]');this.getData("ltPropClick");e&&e.click()},methods:{itemSelected:function(){var t,e,a,i=arguments[4],n=this.getData("ltPropClick"),o=i.element,l=this.getData("auxArray"),s=this.getDataValue(o),r=this.findInd(s),p=this.getData("menuContent");(a=this.$node.querySelector("lyte-nav-item."+n))&&a.classList.remove(n),t=Lyte.arrayUtils(l,"pop"),e=this.recreateFromDv(s),Lyte.arrayUtils(l,"push",e),Lyte.arrayUtils(p,"replaceAt",r,t),this.setSelected(s),this.getMethods("onMenuClick")&&this.executeMethod("onMenuClick")},beforeOpen:function(){this.getMethods("onBeforeOpen")&&this.executeMethod("onBeforeOpen")},open:function(){this.getMethods("onOpen")&&this.executeMethod("onOpen")},beforeClose:function(){this.getMethods("onBeforeClose")&&this.executeMethod("onBeforeClose")},close:function(){this.getMethods("onClose")&&this.executeMethod("onClose")},befRender:function(){this.getData("beforeMenuRender")&&this.executeMethod("beforeMenuRender")},aftRender:function(){this.getData("afterMenuRender")&&this.executeMethod("afterMenuRender")}},data:function(){return{ltPropMenu:Lyte.attr("object",{default:{}}),ltPropNavYield:Lyte.attr("boolean",{default:!1}),ltPropMenuYield:Lyte.attr("boolean",{default:!1}),ltPropItems:Lyte.attr("array",{default:[]}),ltPropUserValue:Lyte.attr("string",{default:""}),ltPropSystemValue:Lyte.attr("string",{default:""}),ltPropMaxWidth:Lyte.attr("string",{default:"90%"}),ltPropType:Lyte.attr("string",{default:""}),ltPropNavMenuClass:Lyte.attr("string",{default:"lyteNavMenuClass"}),ltPropMenuIcon:Lyte.attr("string",{default:"lyteNavKebabMenu"}),ltPropContainerClass:Lyte.attr("string",{default:"lyteNavIconContainer"}),ltPropClick:Lyte.attr("string",{default:"lyteNavActive"}),ltPropAlignment:Lyte.attr("string",{default:"horizontal"}),menuContent:Lyte.attr("array",{default:[]}),auxArray:Lyte.attr("array",{default:[]}),arrowTop:Lyte.attr("boolean",{default:!1}),arrowBot:Lyte.attr("boolean",{default:!1}),showMenu:Lyte.attr("boolean",{default:!1})}}}),Lyte.createCustomElement("lyte-nav-item",{constructor:function(){for(var t,e,a=this,i=this;"LYTE-NAV"!=a.tagName&&"HTML"!=a.tagName;)a=a.parentElement;if("HTML"!=a.tagName){if(t=a.component,"vertical"===(e=t.getData("ltPropAlignment")))for(;!i.classList.contains("lyteNavDiv");)i=i.parentElement;$L.fastdom.measure(function(){var a;this.hasAttribute("selected")&&this.getAttribute("selected")?("vertical"===e&&(a=this.offsetTop,i.scrollTop=a,0!=a&&t.setData("arrowTop",!0),t.setData("arrowBot",!1)),this.classList.add(t.getData("ltPropClick"))):"vertical"===e&&this.offsetTop+this.getBoundingClientRect().height>i.getBoundingClientRect().height+i.scrollTop&&t.setData("arrowBot",!0)},this),this.addEventListener("click",function(){this.setAttribute("selected",!0),t.getMethods("onItemSelected")&&t.executeMethod("onItemSelected",this,t)}.bind(this))}},static:{observedAttributes:{get:function(){return["selected","lyte-shortcut"]}}},attributeChangedCallback:function(t,e,a,i){var n,o,l,s=this;if("lyte-shortcut"===t){if("function"==typeof shortcut){if(!a)return;a=JSON.parse(a),e=e?JSON.parse(e):{},shortcut.push({newKey:a.key,type:a.type,wait:a.wait,oldKey:e.key,value:this})}}else if("selected"==t&&a&&"false"!==a){for(l=this.getAttribute("selected");"LYTE-NAV"!=s.tagName&&"HTML"!=s.tagName;)s=s.parentElement;if("HTML"==s.tagName)return;n=s.component.getData("ltPropClick"),(o=s.querySelector("."+n))&&o!=this&&o.setAttribute("selected",""),l&&this.classList.add(n)}else if("selected"==t){for(s=this;"LYTE-NAV"!=s.tagName&&"HTML"!=s.tagName;)s=s.parentElement;if("HTML"==s.tagName)return;n=s.component.getData("ltPropClick"),this.classList.remove(n)}}}),window.addEventListener("resize",function(t){var e=_lyteUiUtils.lyteNavId;window.clearTimeout(e),_lyteUiUtils.lyteNavId=window.setTimeout(function(){for(var t,e=document.querySelectorAll("lyte-nav"),a=(e.length,0);a<e.length;a++)(t=e[a].component)&&"collapse"===t.getData("ltPropType")&&t.recalculate()},16)});